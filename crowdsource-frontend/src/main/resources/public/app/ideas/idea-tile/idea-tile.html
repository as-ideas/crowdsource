<div class="ideas-grid-tile" ng-class="{'ideas-grid-tile--proposed' : vm.idea.status == 'PROPOSED','ideas-grid-tile--rejected' : vm.idea.status == 'REJECTED','ideas-grid-tile--approved' : vm.idea.status == 'PUBLISHED'}">

    <div ng-if="vm.idea.status == 'PUBLISHED'">
        <span class="ideas-grid-tile__title" title="{{ vm.idea.title }}">{{ vm.idea.title }}</span>
        <span class="ideas-grid-tile__star--single"></span>
        <span class="ideas-grid-tile__votes">{{ vm.rating.averageRating || 0 }} </span>
        <span class="ideas-grid-tile__votes"> von {{ vm.rating.countVotes||Â 0 }} Personen</span>
    </div>

    <div ng-if="!(vm.idea.status == 'PUBLISHED') && !vm.isEditable">
        <span class="ideas-grid-tile__title" title="{{ vm.idea.title }}">{{ idea.title }}</span>
    </div>

    <p ng-if="!vm.isEditable" class="ideas-grid-tile__text">{{::idea.pitch}} <i class="ideas-grid-tile__author">({{::idea.creatorName}})</i></p>

    <div class="ideas-grid-tile__rating ideas-grid-tile__bottom-container" ng-if="vm.idea.status == 'PUBLISHED' && !vm.isAdminView">
    <!-- Approved, regular -->
        <div ng-if="!vm.isVotingDisabled" ng-click="vm.vote(5)" class="star5" ng-class="vm.rating.ownVote >= 5 ? 'ideas-grid-tile__star--rated' : 'ideas-grid-tile__star--unrated'"></div>
        <div ng-if="vm.isVotingDisabled" class="star5" ng-class="vm.rating.ownVote >= 5 ? 'ideas-grid-tile__star--disabled-rated' : 'ideas-grid-tile__star--disabled'"></div>

        <div ng-if="!vm.isVotingDisabled" ng-click="vm.vote(4)" class="star5" ng-class="vm.rating.ownVote >= 4 ? 'ideas-grid-tile__star--rated' : 'ideas-grid-tile__star--unrated'"></div>
        <div ng-if="vm.isVotingDisabled" class="star5" ng-class="vm.rating.ownVote >= 4 ? 'ideas-grid-tile__star--disabled-rated' : 'ideas-grid-tile__star--disabled'"></div>

        <div ng-if="!vm.isVotingDisabled" ng-click="vm.vote(3)" class="star5" ng-class="vm.rating.ownVote >= 3 ? 'ideas-grid-tile__star--rated' : 'ideas-grid-tile__star--unrated'"></div>
        <div ng-if="vm.isVotingDisabled" class="star5" ng-class="vm.rating.ownVote >= 3 ? 'ideas-grid-tile__star--disabled-rated' : 'ideas-grid-tile__star--disabled'"></div>

        <div ng-if="!vm.isVotingDisabled" ng-click="vm.vote(2)" class="star5" ng-class="vm.rating.ownVote >= 2 ? 'ideas-grid-tile__star--rated' : 'ideas-grid-tile__star--unrated'"></div>
        <div ng-if="vm.isVotingDisabled" class="star5" ng-class="vm.rating.ownVote >= 2 ? 'ideas-grid-tile__star--disabled-rated' : 'ideas-grid-tile__star--disabled'"></div>

        <div ng-if="!vm.isVotingDisabled" ng-click="vm.vote(1)" class="star5" ng-class="vm.rating.ownVote >= 1 ? 'ideas-grid-tile__star--rated' : 'ideas-grid-tile__star--unrated'"></div>
        <div ng-if="vm.isVotingDisabled" class="star5" ng-class="vm.rating.ownVote >= 1 ? 'ideas-grid-tile__star--disabled-rated' : 'ideas-grid-tile__star--disabled'"></div>
    </div>


    <div ng-if="vm.isEditable" class="ideas-grid-tile__approval-container">
        <idea-edit idea="vm.idea" cancel-fn="vm.cancelEdit" submit-fn="vm.update"></idea-edit>
    </div>

    <div ng-if="!vm.isAdminView && (vm.idea.status == 'PROPOSED') && !vm.isEditable" class="ideas-grid-tile__edit-container">
        <button campaign-active-aware ng-click="vm.edit()" class="button-secondary--fullwidth">Bearbeiten</button>
    </div>


    <div class="ideas-grid-tile__rejected-container" ng-if="vm.idea.status == 'REJECTED'">
        <p class="ideas-grid-tile__rejected-message">{{vm.idea.rejectionComment}}</p>
    </div>

    <div ng-if="vm.isAdminView" class="ideas-grid-tile__approval-container">
        <div ng-if="vm.idea.status == 'PROPOSED'">

            <form name="rejectionForm">
                <label>
                    <span form-label-valid="rejectionMessage">Ablehnungsgrund</span>
                        <span form-label-invalid="rejectionMessage" ng-messages="rejectionForm.rejectionMessage.$error">
                        <span ng-message="minlength">Mindestens 10 Zeichen</span>
                        <span ng-message="maxlength">Maximal 10000 Zeichen</span>
                        <span ng-message="required">Bitte Ablehnungsgrund angeben</span>
                </span>
                    <input campaign-active-aware type="text" ng-minlength="10" ng-model="vm.rejectionComment" name="rejectionMessage" placeholder="Ablehnungsgrund">
                </label>
            </form>
            <button campaign-active-aware ng-click="vm.reject()" class="button-secondary--halfwidth" ng-disabled="!vm.rejectionComment.length">Ablehnen</button>
            <button campaign-active-aware ng-click="vm.publish()" class="button-primary--halfwidth">Freigeben</button>
        </div>
    </div>
</div>